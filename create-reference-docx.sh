#!/bin/bash
# ========================================
# СОЗДАНИЕ REFERENCE.DOCX ДЛЯ PANDOC
# ========================================
# Создает базовый файл стилей для конвертации LaTeX → DOCX
# согласно требованиям журнала "Вестник МГУ. Серия 13. Востоковедение"

set -e

REFERENCE_FILE="reference-vestnik.docx"
TEMP_MD=$(mktemp /tmp/reference.XXXXXX.md)

echo "📝 Создание файла стилей для pandoc..."

# ========================================
# СОЗДАНИЕ БАЗОВОГО MARKDOWN ДОКУМЕНТА
# ========================================

cat > "$TEMP_MD" << 'EOF'
---
title: "Образец документа"
lang: ru-RU
---

# Заголовок 1 уровня

Это обычный текст документа. Абзацный отступ должен быть 1.25 см.

## Заголовок 2 уровня

Еще один абзац текста для демонстрации форматирования.

### Заголовок 3 уровня

Текст с примером сноски[^1].

[^1]: Текст сноски. Шрифт Times New Roman 10pt, интервал 1.0.

## Список без нумерации

- Элемент списка 1
- Элемент списка 2
- Элемент списка 3

## Нумерованный список

1. Первый элемент
2. Второй элемент
3. Третий элемент

## Форматирование текста

**Полужирный текст**

*Курсивный текст*

***Полужирный курсив***
EOF

# ========================================
# ГЕНЕРАЦИЯ DOCX ЧЕРЕЗ PANDOC
# ========================================

echo "🔄 Генерация базового файла через pandoc..."

pandoc "$TEMP_MD" -o "$REFERENCE_FILE" \
    --standalone \
    --from=markdown \
    --to=docx

rm "$TEMP_MD"

echo "✅ Базовый файл создан: $REFERENCE_FILE"
echo ""

# ========================================
# ИНСТРУКЦИИ ПО НАСТРОЙКЕ СТИЛЕЙ
# ========================================

cat << 'EOF'
📋 ИНСТРУКЦИИ ПО НАСТРОЙКЕ СТИЛЕЙ В MICROSOFT WORD
═══════════════════════════════════════════════════

Откройте файл reference-vestnik.docx в Microsoft Word и настройте следующие стили:

1️⃣  НАСТРОЙКА СТРАНИЦЫ
   ═══════════════════
   Файл → Параметры страницы:
   • Поля: 2.54 см (1 дюйм) со всех сторон
   • Ориентация: Книжная
   • Размер: A4

2️⃣  СТИЛЬ "ОБЫЧНЫЙ" (Normal)
   ══════════════════════════
   Главная → Стили → Обычный → Правой кнопкой → Изменить:

   Шрифт:
   • Шрифт: Times New Roman
   • Размер: 12 пт
   • Цвет: Авто (черный)

   Абзац:
   • Выравнивание: По ширине
   • Отступ первой строки: 1.25 см
   • Междустрочный интервал: 1.5 строки
   • Интервал перед: 0 пт
   • Интервал после: 0 пт

3️⃣  СТИЛЬ "ЗАГОЛОВОК 1" (Heading 1)
   ══════════════════════════════════
   Для названия статьи (ПРОПИСНЫЕ БУКВЫ):

   Шрифт:
   • Шрифт: Times New Roman
   • Размер: 14 пт
   • Начертание: Полужирный
   • Все прописные: ✓

   Абзац:
   • Выравнивание: По центру
   • Отступ первой строки: 0 см
   • Междустрочный интервал: 1.5 строки

4️⃣  СТИЛЬ "ЗАГОЛОВОК 2" (Heading 2)
   ══════════════════════════════════
   Для разделов статьи:

   Шрифт:
   • Шрифт: Times New Roman
   • Размер: 12 пт
   • Начертание: Полужирный

   Абзац:
   • Выравнивание: По ширине
   • Отступ первой строки: 1.25 см
   • Междустрочный интервал: 1.5 строки

5️⃣  СТИЛЬ "ЗАГОЛОВОК 3" (Heading 3)
   ══════════════════════════════════
   Для подразделов:

   Шрифт:
   • Шрифт: Times New Roman
   • Размер: 12 пт
   • Начертание: Полужирный

   Абзац:
   • Выравнивание: По ширине
   • Отступ первой строки: 1.25 см
   • Междустрочный интервал: 1.5 строки

6️⃣  СТИЛЬ "СНОСКИ" (Footnote Text)
   ═════════════════════════════════
   Ссылки → Сноски → Параметры → Формат:

   Шрифт:
   • Шрифт: Times New Roman
   • Размер: 10 пт

   Абзац:
   • Выравнивание: По ширине
   • Отступ первой строки: 0 см
   • Междустрочный интервал: Одинарный (1.0)

7️⃣  НУМЕРАЦИЯ СТРАНИЦ
   ═══════════════════
   Вставка → Номер страницы → Внизу страницы → Простой номер 2 (по центру)

8️⃣  СОХРАНЕНИЕ ФАЙЛА
   ══════════════════
   После настройки всех стилей:
   Файл → Сохранить (не "Сохранить как")

✅ Готово! Теперь файл reference-vestnik.docx можно использовать
   для конвертации LaTeX → DOCX с правильным форматированием.

📌 ПРИМЕЧАНИЕ:
   Этот файл будет использоваться как шаблон стилей при конвертации.
   Pandoc применит эти стили к конвертируемому документу.

EOF

echo "📁 Откройте файл и следуйте инструкциям выше:"
echo "   $PWD/$REFERENCE_FILE"
echo ""
